# WebSocket Data Formats

Документация по форматам данных, получаемых от различных криптовалютных бирж через WebSocket соединения.

## Binance

**Endpoint:** `wss://stream.binance.com:9443/ws/btcusdt@trade`

### Trade Stream Data

```javascript
{
  e: 'trade',              // Тип события - торговая сделка
  E: 1755613765692,        // Время события (timestamp в миллисекундах)
  s: 'BTCUSDT',           // Торговая пара
  t: 5170731426,          // ID сделки
  p: '114130.01000000',   // Цена сделки ($114,130.01)
  q: '0.00438000',        // Количество (объем) - 0.00438 BTC
  T: 1755613765692,       // Время сделки (timestamp)
  m: false,               // Maker side (false = покупка, true = продажа)
  M: true                 // Ignore (можно игнорировать)
}
```

### Поля описание:

-   `e` (string): Тип события, всегда 'trade' для торговых данных
-   `E` (number): Время события в миллисекундах (Unix timestamp)
-   `s` (string): Символ торговой пары
-   `t` (number): Уникальный ID сделки
-   `p` (string): Цена исполнения сделки
-   `q` (string): Объем сделки
-   `T` (number): Время исполнения сделки в миллисекундах
-   `m` (boolean): Является ли покупатель маркет-мейкером (false = taker buy, true = taker sell)
-   `M` (boolean): Игнорировать это поле

---

## Bybit

**Endpoint:** `wss://stream.bybit.com/v5/public/spot`
**Subscription:** `publicTrade.BTCUSDT`

### Trade Stream Data

```javascript
{
  topic: 'publicTrade.BTCUSDT',  // Канал подписки
  ts: 1755613765932,             // Timestamp сообщения
  type: 'snapshot',              // Тип данных (snapshot/delta)
  data: [                        // Массив сделок
    {
      i: '2290000000879452587',   // ID сделки
      T: 1755613765931,           // Timestamp сделки
      p: '114123.9',              // Цена сделки ($114,123.90)
      v: '0.000215',              // Объем - 0.000215 BTC
      S: 'Sell',                  // Сторона сделки (Sell/Buy)
      seq: 82836106168,           // Sequence number
      s: 'BTCUSDT',              // Символ
      BT: false,                  // Block trade flag
      RPI: false                  // Reduce position indicator
    }
  ]
}
```

### Поля описание:

-   `topic` (string): Название канала подписки
-   `ts` (number): Timestamp сообщения в миллисекундах
-   `type` (string): Тип данных ('snapshot' или 'delta')
-   `data` (array): Массив объектов сделок

#### Объект сделки:

-   `i` (string): Уникальный ID сделки
-   `T` (number): Timestamp исполнения сделки в миллисекундах
-   `p` (string): Цена исполнения
-   `v` (string): Объем сделки
-   `S` (string): Сторона сделки ('Buy' или 'Sell')
-   `seq` (number): Порядковый номер для упорядочивания
-   `s` (string): Символ торговой пары
-   `BT` (boolean): Флаг блочной торговли
-   `RPI` (boolean): Индикатор уменьшения позиции

---

## Coinbase

**Endpoint:** `wss://ws-feed.pro.coinbase.com`
**Subscription:** `ticker` channel для `BTC-USD`
**Статус:** ❌ Не удается подключиться

### Данные

```javascript
// Структура данных пока неизвестна
// TODO: Обновить после успешного подключения
```

### Примечания:

-   Подключение к Coinbase WebSocket в настоящее время недоступно
-   Возможные причины: региональные ограничения, изменения в API, сетевые проблемы
-   Документация будет обновлена после решения проблем с подключением

---

## Общие замечания

### Типы данных:

-   Все цены и объемы приходят как строки для точности
-   Timestamps обычно в миллисекундах (Unix timestamp)
-   Boolean значения для флагов

### Обработка ошибок:

-   Всегда проверяйте наличие обязательных полей
-   Учитывайте возможность получения неполных данных
-   Обрабатывайте сетевые ошибки и переподключения

### Производительность:

-   Данные могут приходить с высокой частотой
-   Рекомендуется использовать буферизацию для обработки
-   Следите за потреблением памяти при накоплении данных
